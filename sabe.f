c     programa graficas
      program grafics2
      real a,h,b,a1,a2,a3,h2
      real c11,c12,c13,c14,c15
      real c21,c22,c23,c24,c25
      real c31,c32,c33,c34,c35
    
      real f1,f2,f3
c     se debe ingresar un estimado incial x0
      open(1,file='tablachida.dat',status='unknown')
      
     
c     write(*,*) 'Ingrese x0' 
c      read(*,*) x0
c     ingresamos una tolerancia
c     write(*,*) 'Ingrese la tolerancia' 
c     read(*,*) tol
      tol = 1e-16
      h = 0.01
c      write(*,*) '¿Cuál es el intervalo a graficar?'
c      read(*,*) a,b
      a = 0 
      b= 50

      
      
      a1 = 5
      a2 = 5
      a3 = 5
      t0 = 0
      
      do while (t0.le.b)
c**************************************************************************************************	      	      
        h2 = (h/2)
	c11 = h*f1(t0,a1,a2,a3)
	c12 = h*f2(t0,a1,a2,a3)
	c13 = h*f3(t0,a1,a2,a3)
	
c**************************************************************************************************	
	c21 = h*f1( t0 + h2, a1 + c11, a2 + c12, a3 + c13)
	c22 = h*f2( t0 + h2, a1 + c11, a2 + c12, a3 + c13)
	c23 = h*f3( t0 + h2, a1 + c11, a2 + c12, a3 + c13)
	
c**************************************************************************************************	
	c31 = h*f1( t0 + h2, a1 + h2*c21, a2 + h2*c22, a3 + h2*c23)
	c32 = h*f2( t0 + h2, a1 + h2*c21, a2 + h2*c22, a3 + h2*c23) 
	c33 = h*f3( t0 + h2, a1 + h2*c21, a2 + h2*c22, a3 + h2*c23)
	
c**************************************************************************************************	
	c41 = h*f1( t0 + h, a1 + c31, a2 + c32, a3 + c33 )
	c42 = h*f2( t0 + h, a1 + c31, a2 + c32, a3 + c33 )
	c43 = h*f3( t0 + h, a1 + c31, a2 + c32, a3 + c33 )
	
c***************************************************************************************************	
	write(1,*) t0,a1,a2,a3
	
	a1 = a1 + (c11 + 2*c21 + 2*c31 + c41)/6
	a2 = a2 + (c12 + 2*c22 + 2*c32 + c42)/6
	a3 = a3 + (c13 + 2*c23 + 2*c33 + c43)/6
	t0 = t0 + h
      end do
      
      stop
      close (1,status='keep')
     
      end program


c**********************************************************************************************************
      function f1(t0,a1,a2,a3)
c**********************************************************************************************************
      real f1,a1,a2,a3
      
      f1 = -10*a1 + 10*a2
   
      end function
c----------------------------------------------------------------------------------------------------------

c**********************************************************************************************************
      function f2(t0,a1,a2,a3)
c**********************************************************************************************************
      real f2,a1,a2,a3
      f2 = 28*a1 - a2 - a1*a3  
      
      end function
c----------------------------------------------------------------------------------------------------------

c**********************************************************************************************************
      function f3(t0,a1,a2,a3)
c**********************************************************************************************************
      real f3,a1,a2,a3
      
      f3 = -2.6666667*a3 + a1*a2 
   
      end function
c----------------------------------------------------------------------------------------------------------

