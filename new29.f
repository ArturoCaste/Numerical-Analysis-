c     programa graficas
      program grafics
c     se debe ingresar un estimado incial x0

      
      pi = 3.141592654
      open(1,file='eul1.dat',status='unknown')
      open(2,file='eul2.dat',status='unknown')
      open(3,file='eul3.dat',status='unknown')
c     write(*,*) 'Ingrese x0' 
c      read(*,*) x0
c     ingresamos una tolerancia
c     write(*,*) 'Ingrese la tolerancia' 
c     read(*,*) tol
      tol = 1e-16
      h = 0.1
c      write(*,*) '¿Cuál es el intervalo a graficar?'
c      read(*,*) a,b
      a = 0 
      b= 1
c     Creamos los datos para graficar las funciones
      z=(abs(a)+ abs(b))/1000
      x0=0
c      write(2,*)'	x		F(x)'
      do while (x0.LE.b)
      	Fg=fob(x0)
     	F0 = q(x0)
      	F3 = p(x0)
      	write(2,*) x0,Fg,F0,F3
      	x0= x0 + h 
      end do
      
      y0 = -1
      x0 = 0 
      y1 = -1
      x1 = 0
      
      
      do while (x0.LE.b)
       Fe1  = fob(x0)
       write(1,*) x0,Fe1,y0,y1
       Ff = f(x0,y0)
       Fg = g(x0,y1)
       y0 = Ff
       y1 = Fg

      	x0=x0 + z
      end do
      
    
      

      stop
      close (1,status='keep')
      close (2,status='keep')
      close (3,status='keep')

      end program

c**********************************************************************************************************
      function fob(x)
c**********************************************************************************************************
      
      fob = exp(-x) + 2*x - 2
      
      end function
c----------------------------------------------------------------------------------------------------------


c**********************************************************************************************************
      function f(x,y)
c**********************************************************************************************************
      h=0.1
      
      f = y + h*(2*x - y)
      
      end function
c----------------------------------------------------------------------------------------------------------
      

c**********************************************************************************************************
      function g(x1,y1)
c**********************************************************************************************************
      h=0.1
      fi = 2*x1 - y1 + (0.0483333)*( 2*(1 - x1) + y1)
      g = y1  + h*fi
      
      end function
c----------------------------------------------------------------------------------------------------------
      
      function q(x)
c**********************************************************************************************************
      h= 0.1
      
      f = -1  + h*(2*x  + 1)  - 0.1
      
      end function
c----------------------------------------------------------------------------------------------------------
      

c**********************************************************************************************************
      function p(x)
c**********************************************************************************************************
      h=0.1
      m = h*(0.5 - h/6)
      fi = 2*x + 1 + m*( 2*(1 - x)  - 1)
      nu =   1 + m
      g = -1   + h*fi  - nu*h
      
      end function
c-------------------------------------------------------------------------------------








