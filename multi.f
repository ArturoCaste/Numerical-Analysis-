c     programa graficas
      program grafics2
      real a,h,b,a1,a2,a3,a4,a5
      real c11,c12,c13,c14,c15
      real c21,c22,c23,c24,c25
      real c31,c32,c33,c34,c35
      real c41,c42,c43,c44,c45
      real f1,f2,f3,f4,f5
c     se debe ingresar un estimado incial x0
      open(1,file='tablachida1.dat',status='unknown')
      
c     write(*,*) 'Ingrese x0' 
c      read(*,*) x0
c     ingresamos una tolerancia
c     write(*,*) 'Ingrese la tolerancia' 
c     read(*,*) tol
      tol = 1e-16
      h = 0.1
      h2 = h*0.5
c      write(*,*) '¿Cuál es el intervalo a graficar?'
c      read(*,*) a,b
      a = 0 
      b= 200

      
      
      a1 = 0
      a2 = 0
      a3 = 0
      a4 = 0
      a5 = 0
      t0 = 0
      
      do while (t0.le.b)
c**************************************************************************************************	     
        c11 = h*f1(t0,a1,a2,a3,a4,a5)
	c12 = h*f2(t0,a1,a2,a3,a4,a5)
	c13 = h*f3(t0,a1,a2,a3,a4,a5)
	c14 = h*f4(t0,a1,a2,a3,a4,a5)
	c15 = h*f5(t0,a1,a2,a3,a4,a5)
	
c**************************************************************************************************
        y21 = a1 + c11
        y22 = a2 + c12
        y23 = a3 + c13
        y24 = a4 + c14
        y25 = a5 + c15
        
        c21 = h*f1(t0 + h2,y21, y22, y23,y24,y25)
	c22 = h*f2(t0 + h2,y21, y22, y23,y24,y25)
	c23 = h*f3(t0 + h2,y21, y22, y23,y24,y25)
	c24 = h*f4(t0 + h2,y21, y22, y23,y24,y25)
	c25 = h*f5(t0 + h2,y21, y22, y23,y24,y25)
	
c**************************************************************************************************
        y31 = a1 + h2*c21
        y32 = a2 + h2*c22
        y33 = a3 + h2*c23
        y34 = a4 + h2*c23
        y35 = a5 + h2*c25
        
        c31 = h*f1(t0 + h2,y31, y32, y33,y34,y35)
	c32 = h*f2(t0 + h2,y31, y32, y33,y34,y35)
	c33 = h*f3(t0 + h2,y31, y32, y33,y34,y35)
	c34 = h*f4(t0 + h2,y31, y32, y33,y34,y35)
	c35 = h*f5(t0 + h2,y31, y32, y33,y34,y35)
        	
c**************************************************************************************************
        y41 = a1 + c31
        y42 = a2 + c32
        y43 = a3 + c33
        y44 = a4 + c33
        y45 = a5 + c35
	c41 = h*f1(t0 + h,y41, y42, y43,y44,y45)
	c42 = h*f2(t0 + h,y41, y42, y43,y44,y45)
	c43 = h*f3(t0 + h,y41, y42, y43,y44,y45)
	c44 = h*f4(t0 + h,y41, y42, y43,y44,y45)
	c45 = h*f5(t0 + h,y41, y42, y43,y44,y45)
c***************************************************************************************************	
	
	write(1,*) t0,a1,a2,a3,a4,a5
	
	a1 = a1 + (c11 + 2*c21 + 2*c31 + c41)/6
	a2 = a2 + (c12 + 2*c22 + 2*c32 + c42)/6
	a3 = a3 + (c13 + 2*c23 + 2*c33 + c43)/6
	a4 = a4 + (c14 + 2*c24 + 2*c34 + c44)/6
	a5 = a5 + (c15 + 2*c25 + 2*c35 + c45)/6
	t0 = t0 + h
      end do
      
      stop
      close (1,status='keep')
     
      end program


c**********************************************************************************************************
      function f1(t0,a1,a2,a3,a4,a5)
c**********************************************************************************************************
      real f1,a1,a2,a3,a4,a5
      
      f1 = - 0.12*a1 + 0.02*a3 + 1 
   
      end function
c----------------------------------------------------------------------------------------------------------

c**********************************************************************************************************
      function f2(t0,a1,a2,a3,a4,a5)
c**********************************************************************************************************
      real f2,a1,a2,a3,a4,a5
      f2 = 0.15*a1 - 0.15*a2  
      
      end function
c----------------------------------------------------------------------------------------------------------

c**********************************************************************************************************
      function f3(t0,a1,a2,a3,a4,a5)
c**********************************************************************************************************
      real f3,a1,a2,a3,a4,a5
      
      f3 = 0.025*a2 - 0.225*a3 + 4 
   
      end function
c----------------------------------------------------------------------------------------------------------

c**********************************************************************************************************
      function f4(t0,a1,a2,a3,a4,a5)
c**********************************************************************************************************
      real f4,a1,a2,a3,a4,a5
      f4 = 0.1*a3 - 0.1375*a4 + 0.025*a5 
      
      end function
c----------------------------------------------------------------------------------------------------------

c**********************************************************************************************************
      function f5(t0,a1,a2,a3,a4,a5)
c**********************************************************************************************************
      real f5,a1,a2,a3,a4,a5
      
      f5 = 0.03*a1 + 0.01*a2  - 0.04*a5 
   
      end function
c----------------------------------------------------------------------------------------------------------

